---
layout: default
---
<article class="poem">
  <header class="poem-header">
    <h1 class="poem-title">{{ page.title }}</h1>
    {% comment %}
    {% if page.date %}
    <time class="poem-date" datetime="{{ page.date | date_to_xmlschema }}">
      {{ page.date | date: "%B %d, %Y" }}
    </time>
    {% endif %}
    {% endcomment %}
    {% if page.collection_name %}
    <span class="poem-collection">{{ page.collection_name }}</span>
    {% endif %}
  </header>

  {% if page.sketch %}
  <div class="poem-sketch">
    {% assign file_ext = page.sketch | split: '.' | last | downcase %}
    {% if file_ext == 'mp4' or file_ext == 'webm' or file_ext == 'mov' %}
      <video src="{{ '/assets/sketches/' | append: page.sketch | relative_url }}"
             autoplay
             loop
             muted
             playsinline
             class="sketch-video"
             onclick="togglePoemVideo(this)">
      </video>
    {% else %}
      <img src="{{ '/assets/sketches/' | append: page.sketch | relative_url }}" 
           alt="Artistic sketch accompanying {{ page.title }}" 
           loading="lazy"
           decoding="async">
    {% endif %}
  </div>
  {% endif %}

  <div class="poem-content">
    {{ content }}
  </div>

  {% if page.translation_url %}
  <div class="translation-link">
    <a href="{{ page.translation_url | relative_url }}">
      {% if page.lang == 'es' %}Read in English{% else %}Leer en Español{% endif %}
    </a>
  </div>
  {% endif %}

  <nav class="poem-nav">
    {% assign poems = site[page.collection] | sort: 'date' %}
    {% for poem in poems %}
      {% if poem.url == page.url %}
        {% unless forloop.first %}
          {% assign prev = forloop.index0 | minus: 1 %}
          <a href="{{ poems[prev].url | relative_url }}" class="prev-poem">← {{ poems[prev].title }}</a>
        {% endunless %}
        {% unless forloop.last %}
          {% assign next = forloop.index0 | plus: 1 %}
          <a href="{{ poems[next].url | relative_url }}" class="next-poem">{{ poems[next].title }} →</a>
        {% endunless %}
      {% endif %}
    {% endfor %}
  </nav>
</article>

<script>
// Simple video toggle for poem sketches
function togglePoemVideo(video) {
  if (video.paused) {
    video.play();
    video.style.opacity = '1';
  } else {
    video.pause();
    video.style.opacity = '0.9';
  }
}

// Auto-start videos when they come into view
document.addEventListener('DOMContentLoaded', function() {
  const video = document.querySelector('.sketch-video');
  if (video) {
    video.play().catch(e => {
      // If autoplay fails, show visual cue
      video.style.opacity = '0.9';
    });
  }
});
</script>